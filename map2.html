<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Interactive Map with Draw + Clipboard</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-draw/dist/leaflet.draw.css" />

  <style>
    html, body, #map {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    #copy-notice {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    background-color: #4caf50;
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    font-family: sans-serif;
    display: none;
    z-index: 1000;
  }
  .leaflet-div-icon {
    width: 3px !important;
    height: 3px !important;
    margin-left: -3px !important;
    margin-top: -3px !important;
    border-radius: 2px !important;
    border: 1px solid #000;
    background: #fff;
  }
</style>
</head>
<body>

<div id="copy-notice">Coordinates copied to clipboard!</div>
<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet-draw/dist/leaflet.draw.js"></script>

<script>
  var map = L.map('map').setView([1.2966, 103.7764], 16);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap contributors'
  }).addTo(map);

  // Central Library
  var polygon1 = L.polygon([
  [1.2972361045465322, 103.77373314110584],
  [1.2971449328114608, 103.77400129208101],
  [1.2966139914654433, 103.77384040149587],
  [1.2967158893081603, 103.77353470938417],
  [1.2966837110424985, 103.77351325730613],
  [1.296705163219649, 103.7734435380526],
  [1.2966300805987703, 103.77341672295505],
  [1.2966139914654433, 103.77347035315009],
  [1.2964638262160655, 103.77341672295505],
  [1.2964852783950989, 103.77328264746747],
  [1.2960347825973366, 103.77313248292135],
  [1.296190310917534, 103.77267662626353],
  [1.2966568958207743, 103.77282679080965],
  [1.2966354436432042, 103.77289114704371],
  [1.2966890740867925, 103.77291259912171],
  [1.2967534306176074, 103.77296622931675],
  [1.2967909719264816, 103.77285360590714],
  [1.2969947675935707, 103.77292332516073],
  [1.296967952375167, 103.77300913347278],
  [1.297107391507828, 103.77306276366782],
  [1.2970859393340743, 103.77313784594087],
  [1.2972146523738728, 103.7731807500969],
  [1.297182474114534, 103.77327728444796],
  [1.297209289330673, 103.7733040995455],
  [1.297203926287473, 103.77335236672103],
  [1.2972361045465322, 103.77336309276002],
  [1.2971502958547878, 103.77359370259872],
  [1.2970913023775286, 103.7735829765597],
  [1.2970698502036353, 103.77363124373524]
  ], {
    color: '#000000',
    fillColor: '#008000',
    fillOpacity: 0.5,
    weight: 2
  }).addTo(map);

  polygon1.bindPopup(
  `<b>Central Library</b><br>A conducive place for relaxation and studying.<br><br>` +
  `<b>Stress Rating</b>: ★☆☆☆☆<br><b>Average time spent</b>: 5 hours/week`
);

  polygon1.on('mouseover', function () {
    this.setStyle({ fillColor: '#ff7800' });
    this.openPopup();
  });

  polygon1.on('mouseout', function () {
    this.setStyle({ fillColor: '#008000' });
    this.closePopup();
  });

  // Mochtar Riady Building
  var polygon2 = L.polygon([
    [1.2926406682847937, 103.77376019954683],
    [1.2927318139513266, 103.77394258975984],
    [1.2926621143242878, 103.77417325973512],
    [1.2925709686552487, 103.77443075180055],
    [1.2923297006920422, 103.77452731132509],
    [1.2922760855859792, 103.77439320087433],
    [1.2923618697551127, 103.77413570880891],
    [1.2923404237131124, 103.77404987812042],
    [1.2924959075135973, 103.7738084793091]
  ], {
    color: '#000000',
    fillColor: '#F54927',
    fillOpacity: 0.5,
    weight: 2
  }).addTo(map);

  polygon2.bindPopup(
  `<b>Mochtar Riady Building</b><br>A glass building where lectures and tutorials are conducted.<br><br>` +
  `<b>Stress Rating</b>: ★★★★★<br><b>Average time spent</b>: 10 hours/week`
);

  polygon2.on('mouseover', function () {
    this.setStyle({ fillColor: '#0000FF' });
    this.openPopup();
  });

  polygon2.on('mouseout', function () {
    this.setStyle({ fillColor: '#F54927' });
    this.closePopup();
  });

  // Leaflet Draw Setup
  var drawnItems = new L.FeatureGroup();
  map.addLayer(drawnItems);

var drawControl = new L.Control.Draw({
  draw: {
    polygon: {
      allowIntersection: false,
      showArea: true,
      shapeOptions: {
        color: '#FF0000',
        fillColor: '#FFA07A',
        fillOpacity: 0.5
      }
    },
    polyline: false,
    rectangle: false,
    circle: false,
    marker: false,
    circlemarker: false
  },
  edit: false 
});

  map.addControl(drawControl);

  // Handle drawing completion
  map.on(L.Draw.Event.CREATED, function (event) {
    var layer = event.layer;
    drawnItems.addLayer(layer);

    var latlngs = layer.getLatLngs()[0];

    var formattedCoords = latlngs.map(function(latlng) {
      return `[${latlng.lat}, ${latlng.lng}]`;
    });

    var result = `[\n  ${formattedCoords.join(',\n  ')}\n]`;

    copyToClipboard(result);
    console.log("Copied Polygon Coordinates:\n", result);
  });

  function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(function () {
      showNotice();
    }).catch(function (err) {
      alert('Failed to copy coordinates: ' + err);
    });
  }

  function showNotice() {
    var notice = document.getElementById('copy-notice');
    notice.style.display = 'block';
    setTimeout(() => {
      notice.style.display = 'none';
    }, 2000);
  }
</script>
</body>
</html>
