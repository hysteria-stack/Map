<script>
  // Retrieve polygons info from localStorage
  const polygonsData = JSON.parse(localStorage.getItem('infographicPolygons')) || [];

  var map = L.map('map').setView([1.2966, 103.7764], 16);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Â© OpenStreetMap contributors'
  }).addTo(map);

  polygonsData.forEach(p => {
    var poly = L.polygon(p.coords, {
      color: '#000',
      fillColor: p.color,
      fillOpacity: 0.5,
      weight: 2
    }).addTo(map);

    var center = poly.getBounds().getCenter();

    L.marker(center, {
      icon: L.divIcon({
        className: 'infobox',
        html: p.label.replace(/\n/g, '<br>')
      })
    }).addTo(map);
  });

  // Optional: Adjust map to fit all polygons
  if (polygonsData.length > 0) {
    var allBounds = L.latLngBounds([]);
    polygonsData.forEach(p => allBounds.extend(p.coords));
    map.fitBounds(allBounds);
  }
</script>
